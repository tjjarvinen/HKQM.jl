var documenterSearchIndex = {"docs":
[{"location":"guide/#Package-Guide","page":"Guide","title":"Package Guide","text":"","category":"section"},{"location":"guide/#Define-Grid-for-Calculations","page":"Guide","title":"Define Grid for Calculations","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Start by defining grid used in calculations","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"using HKQM\n\nceg = ElementGridSymmetricBox(5u\"Å\", 4, 24)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"This creates a cubic box with with side length of 5 Å that are divided to 4 elements and 24 Gauss-Lagrange points for each element. Resulting in total of (4*24)^3=884736 points.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"The grid is also an Array that can be used as one","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"typeof(ceg) <: AbstractArray","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"size(ceg)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"eltype(ceg)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"The values are x-, y- and z-coordinates of the grid point in bohr.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ceg[1,1,1,3,3,3]","category":"page"},{"location":"guide/#Operator-algebra","page":"Guide","title":"Operator algebra","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Generate basic operators for the grid","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r = position_operator(ceg)\np = momentum_operator(ceg)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Operators have units defined with Unitful.jl package","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"unit(r)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"unit(p)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"These operator are vector operator and have length defined","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"length(r)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Individual components can be accessed with indexing","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"x = r[1]\ny = r[2]\nz = r[3]\n\nnothing # hide","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Operators support basic algebra operations","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r + r\n2 * r\nr + [1u\"bohr\", 2u\"Å\", 1u\"pm\"]\nr + 1u\"bohr\"\nr / 2\nx * y\n\nnothing # hide","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Units are checked for the operations and operations that do not make sense are prohibited","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r + p","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Vector operations are supported","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r² = r ⋅ r\nl  = r × p\n\nnothing # hide","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Common functions can be used also","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"sin(1u\"bohr^-1\" * x)\nexp(-1u\"bohr^-2\" * r²)\n\nnothing # hide","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Functions require that the input is unitless","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"exp(-r²)","category":"page"},{"location":"guide/#Quantum-States","page":"Guide","title":"Quantum States","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Quantum states can be created from operators","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ψ = QuantumState( exp(-2u\"bohr^-2\" * r²) )","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"States can be normalized","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"normalize!(ψ) ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Complex conjugate can be taken with","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ϕ = conj(ψ)\nconj!(ψ)\n\nnothing # hide","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Quantum states have linear algebra defined","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"2ψ - ψ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Inner product can be calculated with bracket function","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"bracket(ψ, 2ψ) ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Operators can be applied to quantum state by multiplication","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"x * ψ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Vector operators return arrays of quantum state","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r * ψ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Quantum states have units","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"unit(ψ) ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"unit( x * ψ ) ","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Other Unitful functions like dimension and uconvert are defined also.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Expectational values of operators can be calculated with bracket funtion","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"bracket(ψ, x, ψ) ","category":"page"},{"location":"guide/#Slater-Determinant","page":"Guide","title":"Slater Determinant","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Slater determinant is orthonormal set of quantum states","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"st = SlaterDeterminant([ψ, (1u\"bohr^-1\"*x)*ψ])","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Slater determinant is an array of orbitals represented by quantum states","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"length(st)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"st[1]","category":"page"},{"location":"guide/#Hamilton-Operator","page":"Guide","title":"Hamilton Operator","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Hamilton operator is a special operator that is needed for Helmholtz Greens function. To create it you need to create potential energy operator first","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"V = -30u\"eV\" * exp(-0.1u\"bohr^-2\" * r²) \n\nH = HamiltonOperator(V)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Default mass is one electron mass and it can be customized with m keyword","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"H_2me = HamiltonOperator(V; m=2u\"me_au\")\n\nnothing # hide","category":"page"},{"location":"guide/#Solving-Eigen-States-of-a-Hamiltonian","page":"Guide","title":"Solving Eigen-States of a Hamiltonian","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"You need to generate initial state for Hamiltonian that gives negative energy!","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ψ = QuantumState( exp(-0.2u\"bohr^-2\" * r²) )\nnormalize!(ψ)\n\nbracket(ψ, H, ψ)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"After that Helmholtz Greens function can be used to generate better estimate for the lowest eigen-state","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ϕ, E = solve_eigen_states(H, ψ; max_iter=10, rtol=1E-6)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"You can add more states to the solution by giving more initial states","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ψ111 = particle_in_box(ceg, 1,1,1)\nψ112 = particle_in_box(ceg, 1,1,2)\n\nϕ2, E2 = solve_eigen_states(H, ψ111, ψ112)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Once estimate is self consistent a true solution has been found.","category":"page"},{"location":"guide/#Solving-Hartree-Fock-equation","page":"Guide","title":"Solving Hartree-Fock equation","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"Hartree-Fock equation can be solver with scf command.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"V = -100u\"eV\" * exp(-0.1u\"bohr^-2\" * r²) \nH = HamiltonOperator(V)\n\nψ₁ = QuantumState( exp(-0.2u\"bohr^-2\" * r²) )\nψ₂ = 1u\"bohr^-1\"*r[1]*QuantumState( exp(-0.2u\"bohr^-2\" * r²) )\nsd = SlaterDeterminant(ψ₁, ψ₂)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"To check that all eigen-values are negative calculate Fock matrix and look for diagonal values.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"fock_matrix(sd, H)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"After that you can solve Hartree-Fock equations","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"sd1 = scf(sd, H; tol=1E-6, max_iter=10)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"tol is maximum chance in orbital overlap until convergence is archived. max_iter is maximum iterations calculated.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Hartree-Fock energy is calculated by calling hf_energy","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"hf_energy(sd1, H)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Orbital energies can be found from diagonal of Fock matrix","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"fock_matrix(sd1, H)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Check also that off-diagonal elements are insignificant to make sure the system real solution has been found.","category":"page"},{"location":"guide/#Approximate-Nuclear-Potential","page":"Guide","title":"Approximate Nuclear Potential","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"There is an approximation to nuclear potential defined in J. Chem. Phys. 121, 11587 (2004). It allows approximate electronic structure calculations.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Here is an example for Hydrogen molecule.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Define nuclear positions","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"r₁ = [0.37, 0., 0.] .* 1u\"Å\"\nr₂ = [-0.37, 0., 0.] .* 1u\"Å\"","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"After that create nuclear potential","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"V₁ = nuclear_potential_harrison_approximation(ceg, r₁, \"H\")\nV₂ = nuclear_potential_harrison_approximation(ceg, r₂, \"H\")\n\nV = V₁ + V₂","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"and Hamiltonian","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"H = HamiltonOperator(V)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Create initial orbital","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ϕ = particle_in_box(ceg, 1,1,1)\nψ = SlaterDeterminant( ϕ )","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Solve SCF equations","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ψ1 = scf(ψ, H)","category":"page"},{"location":"guide/#Calculations-in-Magnetic-Field","page":"Guide","title":"Calculations in Magnetic Field","text":"","category":"section"},{"location":"guide/","page":"Guide","title":"Guide","text":"To calculate magnetic field effects on the above hydrogen molecule, start by defining magnetic field","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"B = [0., 0., 100.0].*u\"T\"\nA = vector_potential(ceg, B...)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"After that create a magnetic field Hamiltonian","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Hm = HamiltonOperatorMagneticField(V,A)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"You can then just solve the system like above","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"ψm = scf(ψ, Hm)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"It is a good idea to start form no magnetic field case. Because wavefunction is complex in magnetic field and thus more expensive to calculate. By starting from no field case you minimize the iterations needed to solve SCF equations.","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"Magnetic current can be extracted with","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"# current for specific orbital\nj1 = magnetic_current(ψm[1], Hm)\n\n# total magnetic current\nj = magnetic_current(ψm, Hm)\n\n# para magnetic current\njp = para_magnetic_current(ψm)","category":"page"},{"location":"guide/","page":"Guide","title":"Guide","text":"In the future there will be a way to visualize or export the magnetic current!","category":"page"},{"location":"theory/#Theory","page":"Theory","title":"Theory","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"This section is intended to be a self contained reference to theory.","category":"page"},{"location":"theory/#Green's-Functions","page":"Theory","title":"Green's Functions","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"Consider an equation with a linear operator mathcalL","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\nmathcalLu(x)=f(x)\nendequation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"from which we would like to solve u(x). This can be done with a help of a special function called as Green's function G(xs) that is defined as","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"mathcalLG(xs)=delta(x-s)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"where delta(x-s) is Dirac's delta function. Multiplying this with f(s) and integrating over s leads to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"intmathcalLG(xs)f(s)ds=intdelta(x-s)f(s)ds=f(x)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Plugging this definition of f(x) to Eq. (1) leads to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"mathcalLu(x)=f(x)=intmathcalLG(xs)f(s)ds","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Changing order of operating to x and integration of s","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"mathcalLu(x)=mathcalLleft(int G(xs)f(s)dsright)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"leads to solution","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\nu(x)=int G(xs)f(s)ds\nendequation","category":"page"},{"location":"theory/#Poisson-equation","page":"Theory","title":"Poisson equation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"Poisson equation has general form","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"nabla^2 varphi = f","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"it has a Green's function (3D)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\nG(r_1r_2)=frac-14pir_1-r_2\nendequation","category":"page"},{"location":"theory/#Helmholtz-equation","page":"Theory","title":"Helmholtz equation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"Inhomogeneous Helmholtz equation is defined as ","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"(nabla^2 + k^2)varphi = f","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"and has a Green's function (3D)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\nG(r_1r_2)= e^-ikr_1-r_2 frac-14pir_1-r_2\nendequation","category":"page"},{"location":"theory/#Electronic-integrals","page":"Theory","title":"Electronic integrals","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"A charge density rho creates a electric potential phi accordingly Poisson equation (Gauss's Law)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"nabla^2phi = -fracrhovarepsilon_0","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Electric potential can be solved using Poisson equation Green's function Eq. (3)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\nphi(r_1) = -int G(r_1r_2)fracrho(r_2)varepsilon_0 dr_2 = int fracrho(r_2)4pi varepsilon_0 r_1-r_2dr_2 \nendequation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Electric potential can then be used to calculate interaction between two charge densities rho_1 and rho_2 by first calculating electric potential from one charge density and then integrating together with other charge density","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginalign*\nphi_1(r) =  int fracrho_1(r_1)4pi varepsilon_0 r-r_1dr_1 \nE_interaction =  int phi_1(r) rho_2(r) dr\nendalign*","category":"page"},{"location":"theory/#Schrödinger-equation","page":"Theory","title":"Schrödinger equation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"General form of time independent Schrödinger equation is","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"-frachbar^2nabla^22mpsi + Vpsi = Epsi","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"It can be changed to Helmholtz equation from","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"left( nabla^2 + frac2mhbar^2 right)psi = frac2mhbar^2psi","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"with using","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginalign*\nk =  frac sqrt2 mE hbar \nf =  frac2mhbar^2psi\nendalign*","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Green's function can then be used to find a solution to Schrödinger equation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"psi(r_1) = -fracm2pihbar^2int fracexp(-ikr_1-r_2)r_1-r_2V(r_2)psi(r_2)dr_2","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Which is a complex due to e^-ikr_1-r_2 term. If energy is negative, the i in front k can be moved inside the square root in k and make the equation real","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\npsi(r_1) = -fracm2pihbar^2int fracexp(-frac sqrt-2 mE hbarr_1-r_2)r_1-r_2V(r_2)psi(r_2)dr_2\nendequation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This equation is iterative in nature due to it needing energy as an input and because wavefunction is present on both sides of the equation.","category":"page"},{"location":"theory/#Implementation","page":"Theory","title":"Implementation","text":"","category":"section"},{"location":"theory/#Reduce-dimensionality-of-integrals","page":"Theory","title":"Reduce dimensionality of integrals","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"All integrals above are 3-dimensional and thus expensive. It is thus very desirable to reduce the dimensionality of the integrals.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"To do this consider standard Gaussian integral","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\n    int_-infty^infty e^-at^2dt = sqrtfracpia\nendequation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"By taking a=r^2 this equation can be manipulated to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"beginequation\n    frac1r = frac2sqrtpi int_0^inftye^-r^2t^2dt\nendequation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This form allow us to get rid of square root in distance calculation r=sqrtx^2+y^2+z^2, by just separating r^2 term","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"r^2 = x^2 + y^2 + z^2","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"With this the 3-dimensional integral in Eq. (5) can be changes to four 1-dimensional integrals","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"phi(r_1) = frac12varepsilon_0pi^32 int_0^inftydtint rho(r_2) e^-Delta r^2t^2dr_2 nonumber ","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"phi(r_1) = frac12varepsilon_0pi^32 int_0^inftydtint rho(x_2y_2z_2) e^-Delta x^2t^2e^-Delta y^2t^2e^-Delta z^2t^2dx_2dy_2dz_2 nonumber","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"By introducing","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"T(tDelta x) = e^-Delta x^2 t^2 = e^-(x_1-x_2)^2t^2","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"the integral takes form","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"phi(r_1) = frac12varepsilon_0pi^32\nint_0^inftydtint_-infty^infty dx_2 T(t Delta x)\nint_-infty^inftydy_2 T(t Delta y)\nint_-infty^infty dz_2 T(t Delta z)rho(r_2)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This form has four one dimensional integrals that can be calculated in serial fashion. Meaning that the computational complexity was reduced from N^3 to 4N","category":"page"},{"location":"theory/#Helmholtz-Equation","page":"Theory","title":"Helmholtz Equation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"Helmholtz equation differs from Poisson equation by additional exp (-kr) therm","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"fracexp (-kr)r","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"With a standard Laplace transformation [3]","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"int_0^inftyexp(-sp)fracexp(-fraca^24p)sqrtpi pdp\n = fracexp(-asqrts)sqrts","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"and substituting p=t^2, s=r^2 and a=k we get","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"    fracexp (-kr)r = frac2sqrtpi\n    int_0^inftyexp(-frack^24t^2-t^2r^2)dt","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"that is separable in variable r. Using the T that was defined above leads to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"    fracexp (-kr)r = frac2sqrtpi\n    int_0^inftyexp(-frack^24t^2)\n    T(tDelta x)T(tDelta y)T(tDelta z)dt","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This leads to final equation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"    psi(r_1) = -fracmpi^32hbar^2int_0^inftydtexp(-frack^24t^2) int_-infty^inftydx_2 T(t Delta x)\n    int_-infty^inftydy_2 T(t Delta y)\n    int_-infty^inftydz_2 T(t Delta z)\n    V(r_2)psi(r_2)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"that is almost the same as for Poisson equation. With only differences being that charge density is replaced with Vpsi and the extra exp(-frack^24t^2)-term for t-integration.","category":"page"},{"location":"theory/#Basis","page":"Theory","title":"Basis","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"The most accurate way to do general numerical integration is by using Gauss-Legendre quadrature. The integral is performed by calculating values of function in certain points that and summing up with a weight, which gives integral of Legendre polynomial over an interval [a,b]","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"int_a^bf(x)dx approx sum_i=1^Nomega_if(x_i)","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"The basis is thus Gauss-Legendre polynomials, which are divided to elements to control the number of polynomials and spacing in different locations.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"At the current implementation the elements are cubic and contain the same number of Gauss-Legendre points. But the theory does not make this kind of restrictions. It is possible to define elements and Gauss-Lagrange points separately for x-, y- and z-coordinates. But currently due to ease of implementation the program has symmetric implementation. Later of the will be support for more complicated ones.","category":"page"},{"location":"theory/#Tensor-Representation","page":"Theory","title":"Tensor Representation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"The basis is formed of elements and Gauss-Legendre polynomial points each of which have x-,y- and z-coordinates. Thus wavefunctions, densities, etc. are six dimensional tensors.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"rho(xyz) = rho_alphabetagamma IJK","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Where alpha, beta and gamma are indices for Gauss-Lagrange points and I, J and K are indices for elements.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"An integral is then a tensor operation, using Einstein's notation","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"intrho(r)dr = omega_alpha Iomega_beta Jomega_gamma Irho_alphabetagamma IJK","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Where omega is Gauss-Legendre quadrature weight.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"In code this is easily calculated using TensorOperations.jl that impelements tensor networks","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"@tensor ω[α,I]*ω[β,J]*ω[γ,K]*ρ[α,β,γ,I,J,K]","category":"page"},{"location":"theory/#Poisson-Equation","page":"Theory","title":"Poisson Equation","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"In tensor representation the T is a 5-rank tensor","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"T(tx_1x_2) = T_alphaalphaIIt","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"The calculation is done so that position coordinates are contracted first and the integral over t-coordinate is calculated on the way. This is necessary as otherwise the memory needed for intermediate steps would be too much.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"To do this a 4th rank tensor is taken out from T","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"tildeT_alphaalphaII^i = T_alphaalphaIIt_i","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"this leads to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"phi_alphabetagamma IJK=\nfrac12varepsilon_0pi^32sum_i=1^Nomega_i\ntildeT_alphaalphaII^i\ntildeT_betabetaJJ^i\ntildeT_gammagammaKK^i\nrho_alphabetagamma IJK","category":"page"},{"location":"theory/#Helmholtz-Equation-in-Schrödinger-Equation-Case","page":"Theory","title":"Helmholtz Equation in Schrödinger Equation Case","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"The representation is the same except for the extra term and potential energy.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"The calculation is done by first calculating energy to get k. After that the potential energy and the initial state are multiplied","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"tildepsi = Vpsi","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This leads to a following tensor expression","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"phi_alphabetagamma IJK=\n-fracmpi^32hbar^2\nsum_i=1^Nomega_iexp(-frack^24t_i^2)\ntildeT_alphaalphaII^i\ntildeT_betabetaJJ^i\ntildeT_gammagammaKK^i\ntildepsi_alphabetagamma IJK","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"In practice the extra term exp(-frack^24t^2) is included in the integration weight w_i and the constant term in front (fracmpi^32hbar^2) is ignored, because the wavefunction needs to be normalized in any case.","category":"page"},{"location":"theory/#Hartree-Fock","page":"Theory","title":"Hartree-Fock","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"Hartree-Fock equation is an eigen-value equation for Fock matrix","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"F_ij = h_ij + 2J_ij + K_ij","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Where h_ij is one particle Hamiltonian","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"h = frac12nabla^2 + V","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Coulomb operator J is","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"J = intfracsum_kpsi_k(r_2)^2r_1-r_2dr_2","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"and K is exchange operator","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"K_ijpsi_j = sum_kpsi_kintfracpsi_j^*(r_2)psi_k(r_2)r_1-r_2dr_2","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Defining","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"tildeV = V + 2J + K","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"leads to","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"F = frac12nabla^2 + tildeV","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"which is in same form as Schrödinger equation in above and thus can be solved the same way.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"With Helmholtz equation there is only need to calculate the eigen-value of orbital, to calculate k","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"psi_iF_iipsi_i ","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"and applying tildeV to orbitals once per orbital. The Fock matrix is thus only calculated diagonally to occupied orbitals.","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"This has two consequences. First, scaling on number of orbitals is reduced to O(N^2). Secondly, orbitals can be updated on parallel, followed by an orthogonalization. Meaning that the orbital optimization scales linearly on number of orbitals.","category":"page"},{"location":"theory/#Magnetic-Field-Calculations","page":"Theory","title":"Magnetic Field Calculations","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"In magnetic field the Hamiltonian for a charged particle is [4]","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"H = frac12m(-ihbarnabla+qA)^2 + V","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Helmholtz equation needs that nabla^2 is separated to its own term. This leads to the following expression","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"H = -frachbar^22mnabla^2 +ihbar qnabla A -ihbar qAnabla\n    + q^2A^2 + V","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"Defining","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"tildeV = +ihbar qnabla A -ihbar qAnabla + q^2A^2 + V \n          = -p A + q^2A^2 + V","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"leads to general Schrödinger equation type expression","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"H = -frachbar^22mnabla^2 + tildeV","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"which can be solved in the normal way. With the only exception that the wavefunction is now complex.","category":"page"},{"location":"theory/#References","page":"Theory","title":"References","text":"","category":"section"},{"location":"theory/","page":"Theory","title":"Theory","text":"[1] M. H. Kalos; Phys. Rev. 128, (1962) https://doi.org/10.1103/PhysRev.128.1791","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"[2] Harrision, et al.; J. Chem. Phys. 121, 11587 (2004); https://doi.org/10.1063/1.1791051","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"[3] Schum's outlines Mathematical Handbook of Formulas and Tables, 2nd edition; edit. Murray R. Spiegel and John Liu; Mc Graw Hill; 1999; ISBN 0-07-116765-X","category":"page"},{"location":"theory/","page":"Theory","title":"Theory","text":"[4] Lectures on Quantum Mechanics, 2nd edition; Steven Weinberg; Cambridge University press; 2015; ISBN 978-1-107-11166-0","category":"page"},{"location":"accuracy/#Accuracy-Testing","page":"Accuracy Tests","title":"Accuracy Testing","text":"","category":"section"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"There are several ways on how to test accuracy of the calculations, which is nessary in order to know how good the results are.","category":"page"},{"location":"accuracy/#Accuracy-of-Poisson-equation-Greens-function","page":"Accuracy Tests","title":"Accuracy of Poisson equation Greens function","text":"","category":"section"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To test accuracy of Poisson equation and Helmholtz equation use test_accuracy function","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"test_accuracy","category":"page"},{"location":"accuracy/#HKQM.test_accuracy","page":"Accuracy Tests","title":"HKQM.test_accuracy","text":"test_accuracy(a::Real, ne::Int, ng::Int, nt::Int; kwords) -> Dict\n\nTest accuracy on Gaussian charge distribution self energy.\n\nArguments\n\na::Real   : Simulation box size\nne::Int   : Number of elements per dimension\nng::Int   : Number of Gausspoints per dimension for r\nnt::Int   : Number of Gausspoints per dimension for t\n\nKeywords\n\ntmax=300          : Maximum t-value for integration\ntmin=0            : Minimum t-value for integration\nmode=:combination : Integration type - options :normal, :log, :loglocal, :local, :combination and :optimal\nδ=0.25            : Localization parameter for local integration types\ncorrection=true   : Correction to tmax-> ∞ integration - true calculate correction, false do not calculate\ntboundary=20      : Parameter for :combination mode. Switch to :loglocal for t>tboundary else use :log\nα1=1              : 1st Gaussian is exp(-α1*r^2)\nα2=1              : 2nd Gaussian is exp(-α2*r^2)\nd=0               : Distance between two Gaussian centers\n\n\n\n\n\n","category":"function"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"It can be called with","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"using HKQM","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"test_accuracy(5u\"Å\", 4, 24, 96)","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"Which gives accuracy for 5 Å box with 4 elements per dimension and 24^3 Gauss-Lagrange points per element.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"The default mode uses optimal_coulomb_tranformation to calculate Poisson equation","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"optimal_coulomb_tranformation","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"This is usually good enough.","category":"page"},{"location":"accuracy/#Integration-tuning","page":"Accuracy Tests","title":"Integration tuning","text":"","category":"section"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"note: Work in progress\n","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"This is work in progress. More coming later...","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To perform integration there is a so called t variable that has to be integrated from zero to infinity. The main contribution comes from small values.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"Normal mode will use normal Gauss-Lagrange itegration\nLogarithmic will distribute the points in logarithmic fashion\nLocal mean that average value around the points is calculated. This can be used with normal and logarithmic spacing","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"Fanally there is correction for very large values.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To test the integral accuracy calculate without correction and choose how many points are used for t-integrarion nt.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"In example to use logarithmic spacing to integrate from t=20 to t=70 one can use","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"test_accuracy(5u\"Å\", 4, 24, 24; mode=:log, tmin=20, tmax=70, correction=false)","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"From the output we can see that integral is heavily overestimated, see \"integration error\" from output.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To test the same aree with loglocal mode gives","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"test_accuracy(5u\"Å\", 4, 24, 24; mode=:loglocal, tmin=20, tmax=70, correction=false)","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"and we can see that the accuracy was considerably improved.","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To build integral tensor from parts you can use AbstractHelmholtzTensor types","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"HelmholtzTensorLinear\nHelmholtzTensorLog\nHelmholtzTensorLocalLinear\nHelmholtzTensorLocalLog\nHelmholtzTensorCombination","category":"page"},{"location":"accuracy/","page":"Accuracy Tests","title":"Accuracy Tests","text":"To overload the default tensor for calculations you need to create (=redefine) optimal_coulomb_tranformation function that returns HelmholtzTensor.","category":"page"},{"location":"visualization/#Visualizing-Wave-Function","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"","category":"section"},{"location":"visualization/","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"There is an example on plotting wave function in examples folder on the package. You can eather look at it and make your of recipe or include it. By default it uses GLMakie. But you can also use WGLMakie, by loading it instead. Note that GLMakie is probably faster.","category":"page"},{"location":"visualization/","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"To include it just type","category":"page"},{"location":"visualization/","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"include( joinpath(pkgdir(HKQM), \"examples\", \"visualize_wave_function.jl\") )","category":"page"},{"location":"visualization/","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"After that you can use e.g.","category":"page"},{"location":"visualization/","page":"Visualizing Wave Function","title":"Visualizing Wave Function","text":"ceg = ElementGridSymmetricBox(5u\"Å\", 4, 24)\npsi = particle_in_box(ceg, 2, 3, 1)\n\nplot_wave_function(psi; resolution=(800,800))","category":"page"},{"location":"#HKQM.jl","page":"Home","title":"HKQM.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"DocTestSetup = quote\n    using HKQM\nend","category":"page"},{"location":"","page":"Home","title":"Home","text":"Documentation for HKQM.jl","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Installed with Julia package manager. From the Julia REPL, type ] to enter the Pkg REPEL more and run","category":"page"},{"location":"","page":"Home","title":"Home","text":"pkg> add https://github.com/tjjarvinen/HKQM.jl","category":"page"},{"location":"","page":"Home","title":"Home","text":"To test install type","category":"page"},{"location":"","page":"Home","title":"Home","text":"pkg> test HKQM","category":"page"},{"location":"#Running-with-CPU","page":"Home","title":"Running with CPU","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"With CPU there are two things that define how many threads are used Julia number of threads and BLAS number of threads. This option affects on how many cores tensor contractions are done.","category":"page"},{"location":"","page":"Home","title":"Home","text":"From these Julia number of threads can be defined on startup with -t option. It can be checked once started with command","category":"page"},{"location":"","page":"Home","title":"Home","text":"Base.Threads.nthreads()","category":"page"},{"location":"","page":"Home","title":"Home","text":"The second option is how many threads BLAS is using. This can be find out with command","category":"page"},{"location":"","page":"Home","title":"Home","text":"Base.LinearAlgebra.BLAS.get_num_threads()","category":"page"},{"location":"","page":"Home","title":"Home","text":"Setting up number of threads for BLAS is done with","category":"page"},{"location":"","page":"Home","title":"Home","text":"Base.LinearAlgebra.BLAS.set_num_threads(n)","category":"page"},{"location":"#Number-of-Processes","page":"Home","title":"Number of Processes","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Number of Processes defines how many instances of Poisson/Helmholtz Greens functions are run on parallel. That is how many orbitals are updated in parallel. You do not want this option to be higher than number of orbitals. Ideally number of orbitals can be divided by number or processes.","category":"page"},{"location":"","page":"Home","title":"Home","text":"When done on same computer Julia can be started with option -p that defines number of processes used in calculation. See documentation for details. Alternatively you can use Distributed package to start more processes","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Distributed\n\naddprocs(n)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Number of worker processes can found out by typing","category":"page"},{"location":"","page":"Home","title":"Home","text":"nworkers()","category":"page"}]
}
